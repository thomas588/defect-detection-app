Defect Detection Application (YOLO-based)

Оглавление
Введение
Что такое YOLO
Идея Defect Detection (вдохновлённая MVI IBM)
Функциональные возможности
Установка и запуск
Пример использования
Структура проекта
Скриншоты
Контакты
Введение
Данный проект представляет собой веб-приложение на базе Streamlit, осуществляющее детекцию объектов и выявление дефектов с помощью нейронных сетей YOLO. Мы вдохновились подходом IBM MVI (Machine Vision Inspection), применяя современные модели компьютерного зрения для задач контроля качества, распознавания брака, а также мониторинга производственных линий в режиме реального времени.

Приложение позволяет:

Загрузить собственные модели YOLO (файлы .pt) или использовать стандартные предобученные модели, доступные в репозитории Ultralytics.
Задавать пороги Confidence и IoU.
Включать или отключать трекинг объектов (tracking).
Фильтровать детекции по определённым классам (например, если нужно искать дефекты только определённого типа).
Что такое YOLO
YOLO (You Only Look Once) — это семейство моделей для детекции объектов в изображениях и видео. Ключевые особенности YOLO:

Скорость: Работает в режиме реального времени даже на относительно слабых устройствах (в том числе на CPU).
Точность: При корректном обучении способна показывать хорошие результаты, как для обширных датасетов (COCO), так и для узкоспециализированных (дефекты на линии сборки, брак на конвейере и т.д.).
Удобство: Простота интеграции — достаточно загрузить модель в формате .pt и передать в неё изображения или кадры видео.
Подробнее о YOLO можно почитать в официальной документации Ultralytics.

Идея Defect Detection (вдохновлённая MVI IBM)
Вдохновляясь MVI (Machine Vision Inspection) от IBM, мы используем компьютерное зрение для автоматизации выявления дефектов. В классических сценариях MVI:

Система мониторит производственную линию через камеры.
Алгоритмы компьютерного зрения анализируют каждый кадр на предмет появления брака (царапины, трещины, неправильная геометрия и т.д.).
При обнаружении подозрительных объектов (дефектов) система сигнализирует оператору или автоматически останавливает конвейер.
Почему это важно?

Снижает человеческий фактор и вероятность ошибок.
Существенно ускоряет процесс обнаружения брака.
Увеличивает качество продукции и снижает операционные издержки.
Наше приложение Defect Detection следует той же идее, позволяя подменять модели, пороги и логику трекинга под конкретные задачи, будь то контроль печатных плат, деталей на заводе или анализ потока автомобилей для поиска повреждений.

Функциональные возможности
Загрузка собственной модели
Вы можете загрузить свои .pt-файлы (обученные любым из семейств YOLO), чтобы приложение распознавало нужные вам объекты или дефекты.

Выбор стандартной модели
Предустановленные модели семейства YOLO (например, YOLOv8n, YOLOv8s и т.д.) подтягиваются автоматически из репозитория Ultralytics.

Режим видео или камеры

Camera: попытка захвата в реальном времени (локально может не работать в облачных сервисах).
Video: загрузите любой видеоролик в форматах .mp4, .mov, .avi, .mkv для пост-обработки или оффлайн-анализа.
Настройка порогов (Confidence и IoU)

Confidence Threshold: убирает детекции с низкой уверенностью.
IoU Threshold: регулирует подавление пересекающихся bbox (Non-Maximum Suppression).
Трекинг (Enable Tracking)
При включении система старается «следить» за одним и тем же объектом между кадрами, назначая ему уникальный ID.

Выбор классов
Можете указать, какие именно классы (по индексам или названиям) нужно искать, игнорируя всё остальное.

Всплывающие уведомления (toast)
При обнаружении новых классов приложение может выводить уведомления в реальном времени.

Установка и запуск
Клонируйте репозиторий:

bash
Копировать
Редактировать
git clone https://github.com/YourUserName/defect-detection-app.git
cd defect-detection-app
Установите зависимости (через requirements.txt):

bash
Копировать
Редактировать
pip install -r requirements.txt
Убедитесь, что у вас установлены Python 3.8+ и pip.

Запустите Streamlit:

bash
Копировать
Редактировать
streamlit run app.py
По умолчанию откроется локальный сервер по адресу http://localhost:8501.

Проверка работы:

Загрузите (при необходимости) пользовательскую модель YOLO (.pt).
Переключитесь на «video», загрузите видеофайл.
Нажмите кнопку «Старт», чтобы начать обработку.
Пример использования
Откройте приложение в браузере.
В боковой панели:
Нажмите «Загрузите модель (.pt)», если хотите использовать собственные веса.
Выберите одну из стандартных моделей (например, YOLOv8n) или вашу загруженную (помеченную как (user)).
Переключитесь на «video», при необходимости, и загрузите видеоролик.
Настройте Confidence и IoU (или оставьте значения по умолчанию).
Включите «Enable Tracking» в положение «Yes», если нужен трекинг.
Укажите нужные классы (например, defect_crack, defect_scratch, etc.).
Нажмите кнопку Старт: приложение начнёт считывать кадры и выдавать результаты.
mermaid
Копировать
Редактировать
flowchart LR
    A[Загрузка .pt модели] --> B[Установка порогов & классов]
    B --> C[Нажать 'Старт']
    C --> D{Обработка кадров}
    D --> E[Отображение меток дефектов]
    D --> F[Toast уведомление классов]
Графическая схема потоков приложения

Структура проекта
bash
Копировать
Редактировать
defect-detection-app/
├── models/                     # Папка для пользовательских моделей .pt
├── testData/                   # Примеры видео (при необходимости)
├── app.py                      # Главный скрипт Streamlit
├── requirements.txt            # Зависимости
├── README.md                   # Текущий README
└── images/                     # Изображения для README или лого
В папке models/ можно хранить свои обученные файлы YOLO (например, my_custom_defect_model.pt).

Скриншоты
Главная страница

Выбор модели и загрузка видео

Пример детекции дефекта

(Приведённые изображения — примеры, подставьте свои реальные скриншоты.)
